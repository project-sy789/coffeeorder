#!/bin/bash
# ======================================================
# р╕Хр╕┤р╕Фр╕Хр╕▒р╣Йр╕Зр╕Зр╣Ир╕▓р╕вр╣Ж р╕гр╕░р╕Ър╕Ъ POS р╕Др╕▓р╣Ар╕Яр╣Ир╕Ър╕Щ Firebase
# р╣Ар╕лр╕бр╕╖р╕нр╕Щр╕Бр╕▓р╕гр╕Хр╕┤р╕Фр╕Хр╕▒р╣Йр╕З WordPress р╣Бр╕Ър╕Ър╕Др╕ер╕┤р╕Бр╣Ар╕Фр╕╡р╕вр╕з
# ======================================================

echo "ЁЯФе р╣Ар╕гр╕┤р╣Ир╕бр╕Бр╕▓р╕гр╕Хр╕┤р╕Фр╕Хр╕▒р╣Йр╕Зр╕гр╕░р╕Ър╕Ъ POS р╕Др╕▓р╣Ар╕Яр╣Ир╕Ър╕Щ Firebase"
echo "==============================================="

# р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ър╕зр╣Ир╕▓р╕бр╕╡ Node.js р╕Хр╕┤р╕Фр╕Хр╕▒р╣Йр╕Зр╣Бр╕ер╣Йр╕з
if ! command -v node &> /dev/null
then
    echo "тЭМ р╣Др╕бр╣Ир╕Юр╕Ъ Node.js р╣Вр╕Ыр╕гр╕Фр╕Хр╕┤р╕Фр╕Хр╕▒р╣Йр╕Зр╕Бр╣Ир╕нр╕Щр╕Фр╕│р╣Ар╕Щр╕┤р╕Щр╕Бр╕▓р╕гр╕Хр╣Ир╕н"
    echo "р╕Фр╕▓р╕зр╕Щр╣Мр╣Вр╕лр╕ер╕Фр╣Др╕Фр╣Йр╕Чр╕╡р╣И: https://nodejs.org/"
    exit 1
fi

# р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ър╕зр╣Ир╕▓р╕бр╕╡ npm р╕Хр╕┤р╕Фр╕Хр╕▒р╣Йр╕Зр╣Бр╕ер╣Йр╕з
if ! command -v npm &> /dev/null
then
    echo "тЭМ р╣Др╕бр╣Ир╕Юр╕Ъ npm р╣Вр╕Ыр╕гр╕Фр╕Хр╕┤р╕Фр╕Хр╕▒р╣Йр╕З Node.js р╣Гр╕лр╕бр╣И"
    echo "р╕Фр╕▓р╕зр╕Щр╣Мр╣Вр╕лр╕ер╕Фр╣Др╕Фр╣Йр╕Чр╕╡р╣И: https://nodejs.org/"
    exit 1
fi

echo "тЬЕ р╕Юр╕Ъ Node.js р╣Бр╕ер╕░ npm р╣Бр╕ер╣Йр╕з"

# р╕Хр╕┤р╕Фр╕Хр╕▒р╣Йр╕З Firebase Tools р╕лр╕▓р╕Бр╕вр╕▒р╕Зр╣Др╕бр╣Ир╕бр╕╡
if ! command -v firebase &> /dev/null
then
    echo "ЁЯУж р╕Бр╕│р╕ер╕▒р╕Зр╕Хр╕┤р╕Фр╕Хр╕▒р╣Йр╕З Firebase Tools..."
    npm install -g firebase-tools
else
    echo "тЬЕ Firebase Tools р╕Хр╕┤р╕Фр╕Хр╕▒р╣Йр╕Зр╣Бр╕ер╣Йр╕з"
fi

# р╕ер╣Зр╕нр╕Бр╕нр╕┤р╕Щр╣Ар╕Вр╣Йр╕▓ Firebase
echo "ЁЯФС р╕Бр╕гр╕╕р╕Ур╕▓р╕ер╣Зр╕нр╕Бр╕нр╕┤р╕Щр╣Ар╕Вр╣Йр╕▓ Firebase:"
firebase login

# р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ър╕кр╕Цр╕▓р╕Щр╕░р╕Бр╕▓р╕гр╕ер╣Зр╕нр╕Бр╕нр╕┤р╕Щ
if [ $? -ne 0 ]; then
    echo "тЭМ р╕Бр╕▓р╕гр╕ер╣Зр╕нр╕Бр╕нр╕┤р╕Щр╕ер╣Йр╕бр╣Ар╕лр╕ер╕з р╕Бр╕гр╕╕р╕Ур╕▓р╕ер╕нр╕Зр╣Гр╕лр╕бр╣Ир╕нр╕╡р╕Бр╕Др╕гр╕▒р╣Йр╕З"
    exit 1
fi

echo "тЬЕ р╕ер╣Зр╕нр╕Бр╕нр╕┤р╕Щр╕кр╕│р╣Ар╕гр╣Зр╕И"

# р╕кр╕гр╣Йр╕▓р╕Зр╣Др╕Яр╕ер╣М build
echo "ЁЯПЧя╕П р╕Бр╕│р╕ер╕▒р╕Зр╕кр╕гр╣Йр╕▓р╕Зр╣Др╕Яр╕ер╣Мр╕кр╕│р╕лр╕гр╕▒р╕Ъ deploy..."
npm run build

if [ $? -ne 0 ]; then
    echo "тЭМ р╕Бр╕▓р╕гр╕кр╕гр╣Йр╕▓р╕Зр╣Др╕Яр╕ер╣Мр╕ер╣Йр╕бр╣Ар╕лр╕ер╕з р╕Бр╕гр╕╕р╕Ур╕▓р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ър╕Вр╣Йр╕нр╕Ьр╕┤р╕Фр╕Юр╕ер╕▓р╕Ф"
    exit 1
fi

echo "тЬЕ р╕кр╕гр╣Йр╕▓р╕Зр╣Др╕Яр╕ер╣Мр╕кр╕│р╣Ар╕гр╣Зр╕И"

# р╣Ар╕ер╕╖р╕нр╕Бр╣Вр╕Ыр╕гр╣Ар╕Ир╕Д Firebase
echo "ЁЯФН р╕Бр╕гр╕╕р╕Ур╕▓р╣Ар╕ер╕╖р╕нр╕Бр╣Вр╕Ыр╕гр╣Ар╕Ир╕Д Firebase р╕Вр╕нр╕Зр╕Др╕╕р╕У:"
firebase projects:list
echo "ЁЯУЭ р╕Юр╕┤р╕бр╕Юр╣Мр╕Кр╕╖р╣Ир╕нр╣Вр╕Ыр╕гр╣Ар╕Ир╕Д Firebase р╕Вр╕нр╕Зр╕Др╕╕р╕У:"
read project_id

# р╕Хр╕▒р╣Йр╕Зр╕Др╣Ир╕▓р╣Вр╕Ыр╕гр╣Ар╕Ир╕Д Firebase
echo "тЪЩя╕П р╕Бр╕│р╕ер╕▒р╕Зр╕Хр╕▒р╣Йр╕Зр╕Др╣Ир╕▓р╣Вр╕Ыр╕гр╣Ар╕Ир╕Д Firebase..."
firebase use --add $project_id

if [ $? -ne 0 ]; then
    echo "тЭМ р╕Бр╕▓р╕гр╕Хр╕▒р╣Йр╕Зр╕Др╣Ир╕▓р╣Вр╕Ыр╕гр╣Ар╕Ир╕Др╕ер╣Йр╕бр╣Ар╕лр╕ер╕з р╕Бр╕гр╕╕р╕Ур╕▓р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ър╕Кр╕╖р╣Ир╕нр╣Вр╕Ыр╕гр╣Ар╕Ир╕Д"
    exit 1
fi

echo "тЬЕ р╕Хр╕▒р╣Йр╕Зр╕Др╣Ир╕▓р╣Вр╕Ыр╕гр╣Ар╕Ир╕Др╕кр╕│р╣Ар╕гр╣Зр╕И"

# Deploy р╣Бр╕нр╕Ыр╕Юр╕ер╕┤р╣Ар╕Др╕Кр╕▒р╕Щ
echo "ЁЯЪА р╕Бр╕│р╕ер╕▒р╕З Deploy р╣Бр╕нр╕Ыр╕Юр╕ер╕┤р╣Ар╕Др╕Кр╕▒р╕Щ..."
firebase deploy

if [ $? -ne 0 ]; then
    echo "тЭМ р╕Бр╕▓р╕г Deploy р╕ер╣Йр╕бр╣Ар╕лр╕ер╕з р╕Бр╕гр╕╕р╕Ур╕▓р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ър╕Вр╣Йр╕нр╕Ьр╕┤р╕Фр╕Юр╕ер╕▓р╕Ф"
    exit 1
fi

echo "ЁЯОЙ р╕Бр╕▓р╕гр╕Хр╕┤р╕Фр╕Хр╕▒р╣Йр╕Зр╣Ар╕кр╕гр╣Зр╕Ир╕кр╕бр╕Ър╕╣р╕гр╕Ур╣М!"
echo "==============================================="
echo "URL р╕Вр╕нр╕Зр╕гр╕░р╕Ър╕Ъ: https://$project_id.web.app"
echo "ЁЯУ▒ р╕лр╕Щр╣Йр╕▓р╕ер╕╣р╕Бр╕Др╣Йр╕▓: https://$project_id.web.app/customer"
echo "ЁЯТ╝ р╕лр╕Щр╣Йр╕▓ POS: https://$project_id.web.app/pos"
echo "ЁЯФР р╕лр╕Щр╣Йр╕▓р╕Ьр╕╣р╣Йр╕Фр╕╣р╣Бр╕е: https://$project_id.web.app/admin"
echo ""
echo "ЁЯСд р╕ер╣Зр╕нр╕Бр╕нр╕┤р╕Щр╣Ар╕гр╕┤р╣Ир╕бр╕Хр╣Йр╕Щ:"
echo "Username: admin"
echo "Password: admin123"
echo "==============================================="
echo "р╕лр╕▓р╕Бр╕бр╕╡р╕Ыр╕▒р╕Нр╕лр╕▓р╣Гр╕Щр╕Бр╕▓р╕гр╣Гр╕Кр╣Йр╕Зр╕▓р╕Щ р╕Бр╕гр╕╕р╕Ур╕▓р╕Фр╕╣р╕Др╕╣р╣Ир╕бр╕╖р╕нр╣Ар╕Юр╕┤р╣Ир╕бр╣Ар╕Хр╕┤р╕бр╕Чр╕╡р╣Ир╣Др╕Яр╕ер╣М FIREBASE_EASY_INSTALL.md"