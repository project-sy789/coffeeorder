# คู่มือสำหรับระบบ POS คาเฟ่ของฉัน

คู่มือฉบับนี้รวบรวมทุกสิ่งที่คุณต้องรู้เกี่ยวกับการติดตั้ง ใช้งาน และบำรุงรักษาระบบ POS คาเฟ่ของฉัน เพื่อให้คุณสามารถใช้งานระบบได้อย่างราบรื่น

## สารบัญ
1. [การ Deploy ระบบ](#การ-deploy-ระบบ)
   - [Deploy บน Railway.app](#deploy-บน-railwayapp)
   - [Deploy บน Firebase](#deploy-บน-firebase)
2. [การเริ่มต้นใช้งานระบบ](#การเริ่มต้นใช้งานระบบ)
   - [การสร้างบัญชีผู้ดูแลระบบ](#การสร้างบัญชีผู้ดูแลระบบ)
   - [การตั้งค่าร้านค้า](#การตั้งค่าร้านค้า)
   - [การเพิ่มสินค้า](#การเพิ่มสินค้า)
3. [การบำรุงรักษาระบบ](#การบำรุงรักษาระบบ)
   - [การอัพเดตระบบ](#การอัพเดตระบบ)
   - [การสำรองข้อมูล](#การสำรองข้อมูล)
4. [การแก้ไขปัญหาที่พบบ่อย](#การแก้ไขปัญหาที่พบบ่อย)

---

## การ Deploy ระบบ

ระบบ POS คาเฟ่ของฉันสามารถติดตั้งได้สองแพลตฟอร์มหลัก ได้แก่ Railway.app และ Firebase เลือกแพลตฟอร์มที่เหมาะกับความต้องการของคุณ:

- **Railway.app**: เหมาะสำหรับร้านที่มีฐานข้อมูลขนาดใหญ่และต้องการความยืดหยุ่นสูง
- **Firebase**: เหมาะสำหรับร้านขนาดเล็กถึงกลางที่ต้องการความง่ายในการบำรุงรักษา

### Deploy บน Railway.app

Railway.app เป็นแพลตฟอร์มคลาวด์ที่ใช้งานง่ายและมีฐานข้อมูล PostgreSQL ฟรี

#### ขั้นตอนการ Deploy 

1. **เริ่มต้นการติดตั้ง**:
   ```bash
   node simple-deploy-railway.js
   ```
   หรือเรียกใช้ผ่าน:
   ```bash
   npm run deploy-railway
   ```

2. **ทำตามขั้นตอนบนหน้าจอ**:
   - ติดตั้ง Railway CLI (หากยังไม่มี)
   - เข้าสู่ระบบ Railway
   - สร้างหรือเชื่อมต่อกับโปรเจค
   - เพิ่มฐานข้อมูล PostgreSQL (แนะนำให้ใช้)

3. **สิ่งที่จะสร้างขึ้น**:
   - ไฟล์ `Procfile` สำหรับการเริ่มต้นแอปพลิเคชัน
   - ไฟล์ `railway.toml` สำหรับการตั้งค่า Railway
   - ไฟล์ `start-server.js` สำหรับการเริ่มต้นเซิร์ฟเวอร์

### Deploy บน Firebase

Firebase เป็นแพลตฟอร์มของ Google ที่เหมาะกับแอปพลิเคชันขนาดเล็กถึงกลาง

#### ขั้นตอนการ Deploy

1. **เริ่มต้นการติดตั้ง**:
   ```bash
   node simple-deploy-firebase.js
   ```
   หรือเรียกใช้ผ่าน:
   ```bash
   npm run deploy-firebase
   ```

2. **ทำตามขั้นตอนบนหน้าจอ**:
   - ติดตั้ง Firebase CLI (หากยังไม่มี)
   - เข้าสู่ระบบ Firebase
   - เลือกหรือสร้างโปรเจค Firebase
   - ตั้งค่าฟังก์ชัน Firebase และ Hosting

3. **สิ่งที่จะสร้างขึ้น**:
   - ไฟล์ `firebase.json` สำหรับการตั้งค่า Firebase
   - ไฟล์ `.firebaserc` เชื่อมโยงกับโปรเจคของคุณ
   - โฟลเดอร์ `functions` สำหรับฟังก์ชัน Firebase

---

## การเริ่มต้นใช้งานระบบ

หลังจาก Deploy เสร็จเรียบร้อยแล้ว คุณจะต้องตั้งค่าระบบเริ่มต้นเพื่อให้สามารถใช้งานได้

### การสร้างบัญชีผู้ดูแลระบบ

1. **เข้าไปที่ URL**:
   - Railway: `https://<your-app-name>.up.railway.app/api/setup-admin`
   - Firebase: `https://<your-project-id>.web.app/api/setup-admin`

2. **บัญชีเริ่มต้นที่สร้างขึ้น**:
   - Username: `admin`
   - Password: `admin123`

3. **เข้าสู่ระบบ**:
   - เข้าสู่ระบบที่ `[URL ของคุณ]/auth`
   - **สำคัญ**: เปลี่ยนรหัสผ่านทันทีหลังจากเข้าสู่ระบบครั้งแรก!

### การตั้งค่าร้านค้า

1. เข้าสู่เมนู **"ตั้งค่า"** จากแผงควบคุมผู้ดูแลระบบ
2. กรอกข้อมูลร้านค้าของคุณ:
   - ชื่อร้าน
   - ที่อยู่
   - เบอร์โทรศัพท์
   - อัปโหลดโลโก้ร้าน
3. ตั้งค่าภาษีและค่าบริการ (ถ้ามี)
4. บันทึกการตั้งค่า

### การเพิ่มสินค้า

1. ไปที่เมนู **"สินค้า"** ในแผงควบคุม
2. คลิก **"เพิ่มสินค้าใหม่"**
3. กรอกข้อมูลสินค้า:
   - ชื่อสินค้า
   - ราคา
   - หมวดหมู่
   - รูปภาพ (ถ้ามี)
4. เพิ่มตัวเลือกการปรับแต่ง (เช่น ความหวาน, ขนาด)
5. บันทึกสินค้า

---

## การบำรุงรักษาระบบ

### การอัพเดตระบบ

เมื่อมีเวอร์ชันใหม่ของระบบ คุณสามารถอัพเดตได้ดังนี้:

1. **ดาวน์โหลดโค้ดเวอร์ชันใหม่**

2. **Railway**:
   ```bash
   npm run build
   railway up
   ```

3. **Firebase**:
   ```bash
   npm run build
   firebase deploy
   ```

### การสำรองข้อมูล

#### Railway (PostgreSQL)

1. **สำรองฐานข้อมูล**:
   ```bash
   railway connect
   pg_dump -F c > backup.dump
   ```

2. **กู้คืนฐานข้อมูล**:
   ```bash
   railway connect
   pg_restore -d postgres backup.dump
   ```

#### Firebase (Firestore)

1. เข้าไปที่ Firebase Console
2. เลือก Project > Firestore
3. คลิกที่ "Export/Import"
4. ทำตามขั้นตอนการส่งออก/นำเข้าข้อมูล

---

## การแก้ไขปัญหาที่พบบ่อย

### ปัญหาการเชื่อมต่อฐานข้อมูล

**สาเหตุที่เป็นไปได้**:
- ไม่ได้สร้างฐานข้อมูล PostgreSQL บน Railway
- ไม่ได้ตั้งค่าตัวแปร DATABASE_URL

**วิธีแก้ไข**:
1. ตรวจสอบว่าได้สร้างฐานข้อมูลแล้ว
2. ตรวจสอบค่า DATABASE_URL ในการตั้งค่าโปรเจค
3. ลองรันคำสั่ง `railway run npm run db:push` เพื่ออัพเดตโครงสร้างฐานข้อมูล

### ปัญหา Firebase Functions

**สาเหตุที่เป็นไปได้**:
- ไม่ได้ติดตั้งแพ็คเกจใน functions
- Node.js เวอร์ชันไม่ตรงกับที่ Firebase รองรับ
- ปัญหา TypeScript เกี่ยวกับการ import แบบ namespace

**วิธีแก้ไข**:
1. เข้าไปที่โฟลเดอร์ `functions` และรัน `npm install`
2. ตรวจสอบเวอร์ชัน Node.js ใน `firebase.json` (ควรเป็น 18)
3. หากพบข้อผิดพลาดเกี่ยวกับ TypeScript และ import แบบ namespace ให้รันเครื่องมือแก้ไข:
   ```bash
   ./firebase-fix.js
   ```
4. จากนั้น deploy อีกครั้ง: `firebase deploy --only functions`

### ปัญหาการเข้าสู่ระบบ

**สาเหตุที่เป็นไปได้**:
- ยังไม่ได้สร้างบัญชีผู้ดูแลระบบ
- ฐานข้อมูลไม่ได้รับการอัพเดตโครงสร้าง

**วิธีแก้ไข**:
1. เข้าไปที่ `/api/setup-admin` เพื่อสร้างบัญชีเริ่มต้น
2. ตรวจสอบว่าการอัพเดตฐานข้อมูลสำเร็จแล้ว
3. หากยังไม่แก้ไข ลองรีเซ็ตรหัสผ่านผ่าน Firebase Console หรือ PostgreSQL โดยตรง

---

หากคุณพบปัญหาที่ไม่ได้กล่าวถึงในคู่มือนี้ กรุณาติดต่อผู้พัฒนาระบบโดยตรง