# คู่มือสำหรับระบบ POS คาเฟ่ของฉัน

คู่มือฉบับนี้รวบรวมทุกสิ่งที่คุณต้องรู้เกี่ยวกับการติดตั้ง ใช้งาน และบำรุงรักษาระบบ POS คาเฟ่ของฉัน เพื่อให้คุณสามารถใช้งานระบบได้อย่างราบรื่น

## สารบัญ
1. [การติดตั้งระบบ](#การติดตั้งระบบ)
   - [การติดตั้งผ่านหน้าเว็บ](#การติดตั้งผ่านหน้าเว็บ)
   - [การติดตั้งด้วยตนเอง](#การติดตั้งด้วยตนเอง)
2. [การเริ่มต้นใช้งานระบบ](#การเริ่มต้นใช้งานระบบ)
   - [การสร้างบัญชีผู้ดูแลระบบ](#การสร้างบัญชีผู้ดูแลระบบ)
   - [การตั้งค่าร้านค้า](#การตั้งค่าร้านค้า)
   - [การเพิ่มสินค้า](#การเพิ่มสินค้า)
3. [การบำรุงรักษาระบบ](#การบำรุงรักษาระบบ)
   - [การอัพเดตระบบ](#การอัพเดตระบบ)
   - [การสำรองข้อมูล](#การสำรองข้อมูล)
4. [การแก้ไขปัญหาที่พบบ่อย](#การแก้ไขปัญหาที่พบบ่อย)

---

## การติดตั้งระบบ

ระบบ POS คาเฟ่ของฉันสามารถติดตั้งได้ด้วยสองวิธีหลัก:

1. การติดตั้งผ่านหน้าเว็บ (แนะนำสำหรับผู้ใช้ทั่วไป)
2. การติดตั้งด้วยตนเอง (สำหรับผู้ที่มีความรู้ทางเทคนิค)

### การติดตั้งผ่านหน้าเว็บ

การติดตั้งผ่านหน้าเว็บเป็นวิธีที่ง่ายที่สุดสำหรับการเริ่มต้นใช้งานระบบ

#### ขั้นตอนการติดตั้ง

1. **เข้าถึงระบบติดตั้ง**:
   เข้าไปที่ URL: `http://your-domain.com/install` หรือ `http://localhost:5000/install` (สำหรับการพัฒนา)

2. **ทำตามขั้นตอนในระบบติดตั้งอัตโนมัติ** (4 ขั้นตอน):
   - ขั้นตอนที่ 1: ตรวจสอบความพร้อมของระบบ
   - ขั้นตอนที่ 2: ตั้งค่าการเชื่อมต่อฐานข้อมูล PostgreSQL
   - ขั้นตอนที่ 3: กรอกข้อมูลร้านและสร้างบัญชีผู้ดูแลระบบ
   - ขั้นตอนที่ 4: ทำการติดตั้งและตรวจสอบความสำเร็จ

3. **เริ่มใช้งานระบบ**:
   หลังจากติดตั้งสำเร็จ ระบบจะแสดงข้อมูลสำหรับเข้าสู่ระบบ คุณสามารถคลิกเข้าสู่หน้าผู้ดูแลระบบได้ทันที

### การติดตั้งด้วยตนเอง

สำหรับผู้ที่มีความรู้ทางเทคนิค การติดตั้งด้วยตนเองจะช่วยให้มีความยืดหยุ่นมากขึ้น

#### ขั้นตอนการติดตั้ง

1. **ตั้งค่าไฟล์สภาพแวดล้อม**:
   - สำเนาไฟล์ `.env.example` และเปลี่ยนชื่อเป็น `.env.local`
   - แก้ไขค่าในไฟล์ `.env.local` ให้ถูกต้อง โดยเฉพาะ `DATABASE_URL` และ `STORE_NAME`

2. **ติดตั้ง Dependencies**:
   ```bash
   npm install
   ```

3. **สร้างฐานข้อมูล**:
   ```bash
   npm run db:setup
   ```

4. **สร้างบัญชีผู้ดูแลระบบ**:
   ```bash
   npm run create-admin
   ```

5. **เริ่มต้นเซิร์ฟเวอร์**:
   ```bash
   npm run start
   ```

---

## การเริ่มต้นใช้งานระบบ

หลังจาก Deploy เสร็จเรียบร้อยแล้ว คุณจะต้องตั้งค่าระบบเริ่มต้นเพื่อให้สามารถใช้งานได้

### การสร้างบัญชีผู้ดูแลระบบ

1. **เข้าไปที่ URL**:
   - Railway: `https://<your-app-name>.up.railway.app/api/setup-admin`
   - Firebase: `https://<your-project-id>.web.app/api/setup-admin`

2. **บัญชีเริ่มต้นที่สร้างขึ้น**:
   - Username: `admin`
   - Password: `admin123`

3. **เข้าสู่ระบบ**:
   - เข้าสู่ระบบที่ `[URL ของคุณ]/auth`
   - **สำคัญ**: เปลี่ยนรหัสผ่านทันทีหลังจากเข้าสู่ระบบครั้งแรก!

### การตั้งค่าร้านค้า

1. เข้าสู่เมนู **"ตั้งค่า"** จากแผงควบคุมผู้ดูแลระบบ
2. กรอกข้อมูลร้านค้าของคุณ:
   - ชื่อร้าน
   - ที่อยู่
   - เบอร์โทรศัพท์
   - อัปโหลดโลโก้ร้าน
3. ตั้งค่าภาษีและค่าบริการ (ถ้ามี)
4. บันทึกการตั้งค่า

### การเพิ่มสินค้า

1. ไปที่เมนู **"สินค้า"** ในแผงควบคุม
2. คลิก **"เพิ่มสินค้าใหม่"**
3. กรอกข้อมูลสินค้า:
   - ชื่อสินค้า
   - ราคา
   - หมวดหมู่
   - รูปภาพ (ถ้ามี)
4. เพิ่มตัวเลือกการปรับแต่ง (เช่น ความหวาน, ขนาด)
5. บันทึกสินค้า

---

## การบำรุงรักษาระบบ

### การอัพเดตระบบ

เมื่อมีเวอร์ชันใหม่ของระบบ คุณสามารถอัพเดตได้ดังนี้:

1. **สำรองข้อมูล**:
   สำรองฐานข้อมูลก่อนทำการอัพเดตเสมอ
   
2. **ตรวจสอบการเปลี่ยนแปลง**:
   อ่านรายละเอียดการเปลี่ยนแปลงในเวอร์ชันใหม่

3. **อัพเดตซอร์สโค้ด**:
   ```bash
   git pull origin main
   ```

4. **ติดตั้งแพ็กเกจใหม่ (ถ้ามี)**:
   ```bash
   npm install
   ```

5. **อัพเดตโครงสร้างฐานข้อมูล**:
   ```bash
   npm run db:migrate
   ```

6. **รีสตาร์ทแอปพลิเคชัน**:
   ```bash
   npm run start
   ```

### การสำรองข้อมูล

การสำรองข้อมูลเป็นประจำเป็นสิ่งสำคัญมาก เพื่อป้องกันการสูญหายของข้อมูล

#### สำรองฐานข้อมูล PostgreSQL

1. **การสำรองผ่าน Command Line**:
   ```bash
   pg_dump -U username -d database_name -F c > backup_$(date +%Y%m%d).dump
   ```

2. **การกู้คืนข้อมูล**:
   ```bash
   pg_restore -U username -d database_name backup.dump
   ```

#### การตั้งเวลาสำรองอัตโนมัติ

1. สร้างสคริปต์สำรองข้อมูล
2. ตั้งค่า cron job เพื่อเรียกใช้สคริปต์เป็นประจำ
3. จัดเก็บไฟล์สำรองในที่ปลอดภัย (เช่น cloud storage)

---

## การแก้ไขปัญหาที่พบบ่อย

### ปัญหาการเชื่อมต่อฐานข้อมูล

**สาเหตุที่เป็นไปได้**:
- ไม่ได้สร้างฐานข้อมูล PostgreSQL บน Railway
- ไม่ได้ตั้งค่าตัวแปร DATABASE_URL

**วิธีแก้ไข**:
1. ตรวจสอบว่าได้สร้างฐานข้อมูลแล้ว
2. ตรวจสอบค่า DATABASE_URL ในการตั้งค่าโปรเจค
3. ลองรันคำสั่ง `railway run npm run db:push` เพื่ออัพเดตโครงสร้างฐานข้อมูล

### ปัญหาการทำงานของ Socket.io

**สาเหตุที่เป็นไปได้**:
- การเชื่อมต่อ WebSocket ถูกบล็อกโดย Firewall
- มีการใช้พอร์ตผิด
- ไม่ได้ตั้งค่า CORS ให้ถูกต้อง

**วิธีแก้ไข**:
1. ตรวจสอบว่าเปิดพอร์ตสำหรับ WebSocket แล้ว
2. ตรวจสอบว่า client เชื่อมต่อไปยัง URL ที่ถูกต้อง `/ws`
3. ตรวจสอบการตั้งค่า CORS ในไฟล์ `server/realtime.js`

### ปัญหาการเข้าสู่ระบบ

**สาเหตุที่เป็นไปได้**:
- ยังไม่ได้สร้างบัญชีผู้ดูแลระบบ
- ฐานข้อมูลไม่ได้รับการอัพเดตโครงสร้าง

**วิธีแก้ไข**:
1. เข้าไปที่ `/api/setup-admin` เพื่อสร้างบัญชีเริ่มต้น
2. ตรวจสอบว่าการอัพเดตฐานข้อมูลสำเร็จแล้ว
3. หากยังไม่แก้ไข ลองรีเซ็ตรหัสผ่านผ่าน Firebase Console หรือ PostgreSQL โดยตรง

---

หากคุณพบปัญหาที่ไม่ได้กล่าวถึงในคู่มือนี้ กรุณาติดต่อผู้พัฒนาระบบโดยตรง