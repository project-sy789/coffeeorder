# คู่มือติดตั้งระบบร้านคาเฟ่ POS

คู่มือนี้จะแนะนำวิธีการติดตั้งระบบ POS สำหรับร้านคาเฟ่ของคุณ

## วิธีการติดตั้ง

มี 2 วิธีในการติดตั้งระบบ:

### 1. ติดตั้งผ่าน Web Interface

1. เข้าไปที่ URL: `http://your-domain.com/install` หรือ `http://localhost:5000/install` (สำหรับการพัฒนา)
2. ทำตามขั้นตอนในระบบติดตั้งอัตโนมัติ:
   - กรอกข้อมูลการเชื่อมต่อฐานข้อมูล PostgreSQL
   - กรอกข้อมูลร้านคาเฟ่
   - สร้างบัญชีผู้ดูแลระบบ
3. ระบบจะสร้างฐานข้อมูลและตั้งค่าเริ่มต้นให้โดยอัตโนมัติ

### 2. ติดตั้งด้วยตนเอง

1. สำเนาไฟล์ `.env.example` และเปลี่ยนชื่อเป็น `.env.local`
2. แก้ไขค่าในไฟล์ `.env.local` ให้ถูกต้อง โดยเฉพาะ `DATABASE_URL` และ `STORE_NAME`
3. รันคำสั่งเพื่อสร้างฐานข้อมูล:
   ```
   npm run db:setup
   ```
4. รันคำสั่งเพื่อสร้างบัญชีผู้ดูแลระบบ:
   ```
   npm run create-admin
   ```
5. เริ่มต้นใช้งานระบบ:
   ```
   npm run start
   ```

## ข้อกำหนดของระบบ

- Node.js 16.0.0 หรือสูงกว่า
- PostgreSQL 12.0 หรือสูงกว่า
- NPM 8.0.0 หรือสูงกว่า

## การแก้ไขปัญหาเบื้องต้น

### ไม่สามารถเชื่อมต่อกับฐานข้อมูลได้

1. ตรวจสอบว่า PostgreSQL กำลังทำงานอยู่
2. ตรวจสอบรายละเอียดการเชื่อมต่อ (host, port, username, password) ในไฟล์ `.env.local`
3. ตรวจสอบว่าได้สร้างฐานข้อมูลแล้ว

### Error: Cannot find module

1. ตรวจสอบว่าได้ติดตั้ง dependencies ครบถ้วนแล้ว:
   ```
   npm install
   ```

### ปัญหาการเข้าสู่ระบบ

หากลืมรหัสผ่านผู้ดูแลระบบ คุณสามารถรีเซ็ตได้โดย:

1. ตั้งค่า environment variable `ADMIN_RESET_SECRET` ในไฟล์ `.env.local`
2. เข้าไปที่ URL: `http://your-domain.com/api/force-reset-admin?secret_key=your-secret-key`
3. ระบบจะรีเซ็ตรหัสผ่านเป็น `admin123`

## การ Deploy

### การ Deploy บน Render.com

1. Fork หรือ Clone repository นี้
2. สร้าง Web Service ใหม่บน Render.com โดยเชื่อมต่อกับ repository ของคุณ
3. ตั้งค่า environment variables ที่จำเป็น (DATABASE_URL, STORE_NAME)
4. กำหนด Build Command: `npm install && npm run build`
5. กำหนด Start Command: `npm run start`

### การ Deploy บน Railway

1. Fork หรือ Clone repository นี้
2. สร้าง Project ใหม่บน Railway โดยเชื่อมต่อกับ repository ของคุณ
3. เพิ่ม PostgreSQL add-on
4. ตั้งค่า environment variables ที่จำเป็น (STORE_NAME)
5. Railway จะตรวจจับ `Procfile` และ deploy โดยอัตโนมัติ

## การอัปเดต

การอัปเดตระบบสามารถทำได้โดย:

1. Backup ฐานข้อมูลก่อนอัปเดต
2. Pull เวอร์ชันล่าสุดจาก repository
3. รันคำสั่ง:
   ```
   npm install
   npm run db:migrate
   npm run build
   npm run start
   ```

## การสำรองข้อมูล

ควรสำรองข้อมูลเป็นประจำโดยใช้คำสั่ง:

```
pg_dump -U username -d dbname > backup.sql
```

## การติดต่อสอบถาม

หากมีปัญหาในการติดตั้งหรือใช้งาน สามารถติดต่อผู้พัฒนาได้ที่:
- อีเมล: support@example.com
- Line: @cafepos